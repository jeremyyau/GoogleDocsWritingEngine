<main class="container-xxl w-100 h-100">
    <center><div id="columnchart_material" class="w-100 mb-4" style="height: 500px;"></div></center>
    <? if (wordCounts>=goalAll) { ?>
      <h6>總字數<span class="badge rounded-pill text-bg-success ms-1">達標</span><span class="badge rounded-pill text-bg-secondary ms-1">⌛預計閱讀時間：<?=Math.floor(totalPredictTime/60)?>小時<?=totalPredictTime%60?>分鐘</span></h6>
      <div class="progress mb-4" style='font-size: 14px;height: 24px;' role="progressbar" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-bar bg-success" style="width: <?=Math.round(Math.min(wordCounts,goalAll)/goalAll*100)?>%"><?=wordCounts?>/<?=goalAll?> (<?=Math.round(Math.min(wordCounts,goalAll)/goalAll*100)?>%)</div>
      </div>
    <? } else { ?>
      <h6>總字數<span class="badge rounded-pill text-bg-danger ms-1">未達標</span><span class="badge rounded-pill text-bg-secondary ms-1">⌛預計閱讀時間：<?=Math.floor(totalPredictTime/60)?>小時<?=totalPredictTime%60?>分鐘</span></h6>
      <div class="progress mb-4" style='font-size: 14px;height: 24px;' role="progressbar" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger" style="width: <?=Math.round(Math.min(wordCounts,goalAll)/goalAll*100)?>%">
          <span class="innerProgress"><?=wordCounts?>/<?=goalAll?> (<?=Math.round(Math.min(wordCounts,goalAll)/goalAll*100)?>%)</span>
        </div>
      </div>
    <? } ?>
    <div class="accordion" id="accordionExample">
      <? for (let i in reportResult) { ?>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse<?=i?>" aria-expanded="false">
            <strong><?=reportResult[i]["heading1"]?></strong><span class="badge rounded-pill text-bg-secondary ms-1">🔢<?=reportResult[i]["heading1Counts"]?>字</span><span class="badge rounded-pill text-bg-secondary ms-1">⌛預計閱讀時間：<?=reportResult[i]["heading1PredictTime"]?>分鐘</span>
          </button>
        </h2>
        <div id="collapse<?=i?>" class="accordion-collapse collapse">
          <div class="accordion-body">
            <? for (let x in reportResult[i]["heading2"]) { ?>
              <? if (reportResult[i]["heading2Counts"] != null) { ?>
                <? if (reportResult[i]["heading2Counts"][x]>=goal) { ?>
                  <p><?=reportResult[i]["heading2"][x]?><span class="badge rounded-pill text-bg-success ms-1">達標</span><span class="badge rounded-pill text-bg-secondary ms-1">⌛預計閱讀時間：<?=reportResult[i]["heading2PredictTime"][x]?>分鐘</span></p>
                  <div class="progress mb-4" style='font-size: 14px;height: 24px;' role="progressbar" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar bg-success" style="width: <?=Math.round(Math.min(reportResult[i]["heading2Counts"][x],goal)/goal*100)?>%"><?=reportResult[i]["heading2Counts"][x]?>/<?=goal?> (<?=Math.round(Math.min(reportResult[i]["heading2Counts"][x],goal)/goal*100)?>%)</div>
                  </div>
                <? } else { ?>
                  <p><?=reportResult[i]["heading2"][x]?><span class="badge rounded-pill text-bg-danger ms-1">未達標</span><span class="badge rounded-pill text-bg-secondary ms-1">⌛預計閱讀時間：<?=reportResult[i]["heading2PredictTime"][x]?>分鐘</span></p>
                  <div class="progress mb-4" style='font-size: 14px;height: 24px;' role="progressbar" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger" style="width: <?=Math.round(Math.min(reportResult[i]["heading2Counts"][x],goal)/goal*100)?>%">
                      <span class="innerProgress"><?=reportResult[i]["heading2Counts"][x]?>/<?=goal?> (<?=Math.round(Math.min(reportResult[i]["heading2Counts"][x],goal)/goal*100)?>%)</span>
                    </div>
                  </div>
                <? } ?>
              <? } else { ?>
                <p><?=reportResult[i]["heading2"][x]?><span class="badge rounded-pill text-bg-danger ms-1">未達標</span></p>
                <div class="progress mb-4" style='font-size: 14px;height: 24px;' role="progressbar" aria-valuemin="0" aria-valuemax="100">
                  <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger" style="width: <?=Math.round(Math.min(reportResult[i]["heading1Counts"],goal)/goal*100)?>%">
                    
                    <span class="innerProgress"><?=reportResult[i]["heading1Counts"]?>/<?=goal?> (<?=Math.round(Math.min(reportResult[i]["heading1Counts"],goal)/goal*100)?>%)</span>
                  </div>
                </div>
              <? } ?>
            <? } ?>
          </div>
        </div>
      </div>
      <? } ?>
    </div>
  </main>